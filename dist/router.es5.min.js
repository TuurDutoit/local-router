!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Router=e.Router||{})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),i=function(e){return JSON.stringify(e)},o=function(e){return JSON.parse(e)},a=function(e){return"string"==typeof e?document.getElementById(e)||document.querySelector(e):e},r=function(e){var n={};return Object.keys(e).forEach(function(s){var a=e[s];a===!0?n[s]={encode:i,decode:o}:"object"===("undefined"==typeof a?"undefined":t(a))?(n[s]=a,a.encode||(a.encode=i),a.decode||(a.decode=o)):n[s]=!1}),n},c=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],s=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=s.index,o=void 0===i?"index":i,c=s.prefix,h=void 0===c?"page-":c,u=s.elem,l=void 0===u?document.body:u,d=s.invalid,f=void 0===d?o:d;n(this,e),this.$elem=a(l),this.prefix=h,this.index=o,this.invalid=f,this.routes=r(t),this.names=Object.keys(t),this.callbacks={"*":[]},this.hashes={},this.current=null,this.init()}return s(e,[{key:"init",value:function(){var e=this;this.genChecks(),this.names.forEach(function(t){e.callbacks[t]=[],e.hashes[t]=new RegExp("^#"+e.getHash(t)+"$","i")}),window.addEventListener("hashchange",this),window.addEventListener("load",this)}},{key:"genChecks",value:function(){this.rnames=new RegExp("^("+this.names.join("|")+")$","i"),this.rhashes=new RegExp("^#("+this.names.map(this.getHash,this).join("|")+")$","i"),this.rcallbacks=new RegExp("^("+this.names.join("|")+"|\\*)$")}},{key:"getHash",value:function(e){return this.routes[e]?e+"-.*":e}},{key:"addRoute",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return this.rnames.test(e)||(this.routes[e]=t.encode&&t.decode?t:!1,this.names.push(e),this.callbacks[e]=[],this.hashes[e]=new RegExp("^#"+this.getHash(t)+"$","i"),this.genChecks()),this}},{key:"removeRoute",value:function(e){return this.rnames.test(e)&&(this.routes[e]=void 0,this.names.splice(this.names.indexOf(e),1),this.callbacks[e]=void 0,this.hashes[e]=void 0,this.genChecks()),this}},{key:"handleEvent",value:function(){var e=this,t=location.hash;this.rhashes.test(t)?!function(){for(var n=void 0,s=void 0,i=0,o=e.names.length;o>i;i++)if(n=e.names[i],e.hashes[n].test(t)){if(e.routes[n]){var a=decodeURIComponent(t.slice(n.length+2));s=e.routes[n].decode(a)}break}e.current&&e.$elem.classList.remove(e.prefix+e.current),e.current=n,e.$elem.classList.add(e.prefix+n),e.callbacks[n].forEach(function(n){n(s,t,e)}),e.callbacks["*"].forEach(function(i){i(n,s,t,e)})}():this.invalid&&(location.hash="#"+this.invalid)}},{key:"on",value:function(e,t){return this.rcallbacks.test(e)&&this.callbacks[e].push(t),this}},{key:"off",value:function(e,t){if(this.rcallbacks.test(e)){var n=this.callbacks[e].indexOf(t);-1!==n&&this.callbacks[e].splice(n,1)}return this}},{key:"go",value:function(e,t){if(this.rnames.test(e)){this.routes[e]&&(e+="-"+encodeURIComponent(this.routes[e].encode(t)));var n="#"+e;location.hash!==n&&(location.hash=n)}return this}}]),e}();e.encode=i,e.decode=o,e.getElem=a,e.processRoutes=r,e["default"]=c,Object.defineProperty(e,"__esModule",{value:!0})});